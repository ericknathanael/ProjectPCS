DROP TABLE JENIS_MENU CASCADE CONSTRAINT PURGE;
DROP TABLE MENU CASCADE CONSTRAINT PURGE;
DROP TABLE JABATAN CASCADE CONSTRAINT PURGE;
DROP TABLE KARYAWAN CASCADE CONSTRAINT PURGE;
DROP TABLE JADWAL CASCADE CONSTRAINT PURGE;
DROP TABLE ABSENSI CASCADE CONSTRAINT PURGE;
DROP TABLE IZIN_ABSENSI CASCADE CONSTRAINT PURGE;
DROP TABLE PENGGAJIAN CASCADE CONSTRAINT PURGE;
DROP TABLE D_PENGGAJIAN CASCADE CONSTRAINT PURGE;
DROP TABLE PELANGGAN CASCADE CONSTRAINT PURGE;
DROP TABLE VOUCHER CASCADE CONSTRAINT PURGE;
DROP TABLE TRANSAKSI CASCADE CONSTRAINT PURGE;
DROP TABLE D_TRANSAKSI CASCADE CONSTRAINT PURGE;


create table jenis_menu ( --sudah
	ID NUMBER PRIMARY KEY,
	KODE_JENIS VARCHAR2(5) NOT NULL,
	NAMA_JENIS VARCHAR(50) NOT NULL
);

create table menu( --sudah
	ID NUMBER PRIMARY KEY,
	ID_JENIS_MENU NUMBER REFERENCES JENIS_MENU(ID),
	KODE_MENU VARCHAR2(5) NOT NULL,
	NAMA_MENU VARCHAR2(255) NOT NULL,
	STATUS NUMBER NOT NULL CHECK(STATUS = 0 OR STATUS = 1),
	HARGA NUMBER NOT NULL
);

CREATE TABLE JABATAN(
	ID NUMBER PRIMARY KEY,
	NAMA_JABATAN VARCHAR2(50) NOT NULL CHECK(NAMA_JABATAN IN ('MANAJER', 'KOKI', 'PELAYAN', 'KASIR')),
	GAJI_POKOK NUMBER NOT NULL
);

CREATE TABLE KARYAWAN(
	ID NUMBER PRIMARY KEY,
	ID_JABATAN NUMBER REFERENCES JABATAN(ID),
	USERNAME VARCHAR2(12) UNIQUE,
	PASSWORD VARCHAR2(50) NOT NULL,
	NAMA_KARYAWAN VARCHAR2(50) NOT NULL,
	TGL_DAFTAR DATE NOT NULL
);

CREATE TABLE ABSENSI(
	ID NUMBER PRIMARY KEY,
	ID_KARYAWAN NUMBER REFERENCES KARYAWAN(ID),
	JAM_MASUK VARCHAR2(50) NOT NULL,
	JAM_PULANG VARCHAR2(50) NOT NULL,
	TGL_WAKTU_ABSEN DATE NOT NULL
);

CREATE TABLE IZIN_ABSENSI( -- ini table untuk absensi karyawan ketika izin tidak masuk atau absen
	ID NUMBER PRIMARY KEY,
	ID_KARYAWAN NUMBER REFERENCES KARYAWAN(ID),
	JENIS_IZIN_ABSENSI VARCHAR2(4) NOT NULL CHECK(JENIS_IZIN_ABSENSI NOT IN('IZIN', 'CUTI')),
	TGL_MULAI DATE NOT NULL,
	TGL_AKHIR DATE NOT NULL
);

CREATE TABLE PENGGAJIAN(
	NOMOR_SLIP VARCHAR2(15) PRIMARY KEY,
	ID_KARYAWAN NUMBER REFERENCES KARYAWAN(ID),
	TOTAL_GAJI_BERSIH NUMBER NOT NULL,
	TGL_WAKTU_PENGGAJIAN DATE NOT NULL
);

CREATE TABLE D_PENGGAJIAN(
	NOMOR_SLIP VARCHAR2(15) REFERENCES PENGGAJIAN(NOMOR_SLIP),
	ID_KARYAWAN NUMBER REFERENCES KARYAWAN(ID),
	ID_JABATAN NUMBER REFERENCES JABATAN(ID),
	GAJI_POKOK NUMBER NOT NULL,
	-- TUNJANGAN NUMBER NOT NULL,
	TOTAL_TRANSPORT NUMBER NOT NULL,
	TOTAL_MAKAN NUMBER NOT NULL
	-- BONUS NUMBER NOT NULL,
	-- TOTAL_POTONGAN NUMBER NOT NULL
);

CREATE TABLE PELANGGAN(
	ID NUMBER PRIMARY KEY,
	NAMA_PELANGGAN VARCHAR2(50) NOT NULL,
	ALAMAT VARCHAR2(50) NOT NULL,
	NO_TELP VARCHAR(12) UNIQUE
);

CREATE TABLE VOUCHER(
	ID NUMBER PRIMARY KEY,
	NAMA VARCHAR2(50) NOT NULL,
	NILAI NUMBER NOT NULL
);

CREATE TABLE TRANSAKSI(
	ID NUMBER PRIMARY KEY,
	NOMOR_NOTA VARCHAR2(15) NOT NULL,
	METODE_PEMBAYARAN VARCHAR2(50) NOT NULL,
	TOTAL_PEMBELIAN NUMBER NOT NULL,
	POTONGAN_PEMBELIAN NUMBER NOT NULL,
	TOTAL_AKHIR NUMBER NOT NULL,
	TGL_PEMBELIAN DATE NOT NULL
);

CREATE TABLE D_TRANSAKSI(
	ID_TRANSAKSI NUMBER REFERENCES TRANSAKSI(ID),
	ID_PELANGGAN NUMBER REFERENCES PELANGGAN(ID),
	ID_MENU NUMBER REFERENCES MENU(ID)
);


ALTER SESSION SET NLS_DATE_FORMAT = 'DD-MON-YYYY HH24:MI:SS';
ALTER SESSION SET NLS_DATE_FORMAT = 'DD-MM-YYYY HH24:MI:SS';
select current_date from dual;

INSERT INTO JENIS_MENU VALUES(1,'SE001','SEAFOOD');
INSERT INTO JENIS_MENU VALUES(2,'AY001','AYAM');
INSERT INTO JENIS_MENU VALUES(3,'SA001','SAYUR');

INSERT INTO MENU VALUES(1,1,'CG001','CUMI GORENG TEPUNG',1,35000);
INSERT INTO MENU VALUES(2,1,'CG002','CUMI GORENG MENTEGA',0,20000);
INSERT INTO MENU VALUES(3,2,'AB001','AYAM BAKAR',1,35000);
INSERT INTO MENU VALUES(4,3,'CB001','CAH BABY KAILAN',0,37000);
INSERT INTO MENU VALUES(5,3,'CK001','CAH KANGKUNG',1,21000);

INSERT INTO PELANGGAN VALUES(1,'BUDI DOREMI','JL. BUNTU 4 NO 7','087853111900');
INSERT INTO PELANGGAN VALUES(2,'MICHAEL ANGELO', 'JL. RAYA 6 NO 10','08972018528');
INSERT INTO PELANGGAN VALUES(3,'BIMA SAPUTRA','JL. NINJA 2 NO 17','08977205819');

INSERT INTO JABATAN VALUES(1,'MANAJER',5000000);
INSERT INTO JABATAN VALUES(2,'KOKI',6000000);
INSERT INTO JABATAN VALUES(3,'PELAYAN',3500000);
INSERT INTO JABATAN VALUES(4,'KASIR',4000000);

INSERT INTO KARYAWAN VALUES(1,1,'PATKUS123','PatricKus','PATRICK KUSANAGI',TO_DATE('12/03/2018','DD/MM/YYYY'));
INSERT INTO KARYAWAN VALUES(2,3,'ANDREHEBAT','AndrianSug','ANDRIAN SUGIANTO',TO_DATE('12/03/2018','DD/MM/YYYY'));
INSERT INTO KARYAWAN VALUES(3,4,'LUKKY23','LukkyHar','LUKKY HARIYANTO',TO_DATE('24/12/2020','DD/MM/YYYY'));
INSERT INTO KARYAWAN VALUES(4,2,'STEVEN57','StevenLim','STEVEN LIEM',TO_DATE('24/01/2021','DD/MM/YYYY'));

INSERT INTO ABSENSI VALUES(1,1,TO_CHAR(TO_DATE('10:24:30','HH24:MI:SS'),'HH24:MI:SS'),TO_CHAR(TO_DATE('15:24:30','HH24:MI:SS'),'HH24:MI:SS'),TO_TIMESTAMP('12/12/2000 22:24:30','DD-MM-YYYY HH24:MI:SS'));
INSERT INTO ABSENSI VALUES(2,2,TO_CHAR(TO_DATE('09:11:14','HH24:MI:SS'),'HH24:MI:SS'),TO_CHAR(TO_DATE('17:11:12','HH24:MI:SS'),'HH24:MI:SS'),TO_TIMESTAMP('12/12/2000 22:24:30','DD-MM-YYYY HH24:MI:SS'));
INSERT INTO ABSENSI VALUES(3,3,TO_CHAR(TO_DATE('10:03:24','HH24:MI:SS'),'HH24:MI:SS'),TO_CHAR(TO_DATE('16:07:01','HH24:MI:SS'),'HH24:MI:SS'),TO_TIMESTAMP('13/12/2000 22:24:30','DD-MM-YYYY HH24:MI:SS'));
INSERT INTO ABSENSI VALUES(4,4,TO_CHAR(TO_DATE('10:01:01','HH24:MI:SS'),'HH24:MI:SS'),TO_CHAR(TO_DATE('17:10:19','HH24:MI:SS'),'HH24:MI:SS'),TO_TIMESTAMP('04/11/2000 22:24:30','DD-MM-YYYY HH24:MI:SS'));
INSERT INTO ABSENSI VALUES(5,5,TO_CHAR(TO_DATE('10:08:30','HH24:MI:SS'),'HH24:MI:SS'),TO_CHAR(TO_DATE('18:02:56','HH24:MI:SS'),'HH24:MI:SS'),TO_TIMESTAMP('22/02/2000 22:24:30','DD-MM-YYYY HH24:MI:SS'));


COMMIT;
